<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mariana Trench Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mariana Trench Blog Atom Feed"><title data-react-helmet="true">Running on 3rd-Party Apps | Mariana Trench</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Running on 3rd-Party Apps | Mariana Trench"><meta data-react-helmet="true" name="description" content="This guide will walk you through the process to run Mariana Trench on 3rd party apps. We often use Mariana Trench to analyze our own applications where we have the source code readily available but Mariana Trench runs on byte-code and does not necessarily need access to source code."><meta data-react-helmet="true" property="og:description" content="This guide will walk you through the process to run Mariana Trench on 3rd party apps. We often use Mariana Trench to analyze our own applications where we have the source code readily available but Mariana Trench runs on byte-code and does not necessarily need access to source code."><meta data-react-helmet="true" property="og:url" content="https://mariana-tren.ch/docs/running-on-3rd-party-apps"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mariana-tren.ch/docs/running-on-3rd-party-apps"><link rel="stylesheet" href="/styles.9e004259.css">
<link rel="preload" href="/styles.032abe41.js" as="script">
<link rel="preload" href="/runtime~main.4d463931.js" as="script">
<link rel="preload" href="/main.5b59f7f6.js" as="script">
<link rel="preload" href="/common.cb11aae3.js" as="script">
<link rel="preload" href="/2.b3ce0de2.js" as="script">
<link rel="preload" href="/1be78505.33ff38f6.js" as="script">
<link rel="preload" href="/25.b8db153a.js" as="script">
<link rel="preload" href="/935f2afb.4c698189.js" as="script">
<link rel="preload" href="/17896441.f69af79b.js" as="script">
<link rel="preload" href="/6bf0c53e.4997e5fe.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Mariana Trench</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/mariana-trench" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Mariana Trench</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/getting-started">Documentation</a></li><li class="menu__list-item"><a href="https://github.com/facebook/mariana-trench" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/models">Models</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/running-on-3rd-party-apps">Running on 3rd-Party Apps</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/developers-guide">Developer&#x27;s Guide</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Running on 3rd-Party Apps</h1></header><div class="markdown"><p>This guide will walk you through the process to run Mariana Trench on 3rd party apps. We often use Mariana Trench to analyze our own applications where we have the source code readily available but Mariana Trench runs on byte-code and does not necessarily need access to source code.</p><p>This guide assumes you are familiar with running Mariana Trench. If you are not, read the <a href="/docs/getting-started">Getting Started</a> guide first.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="getting-the-apk"></a>Getting the APK<a class="hash-link" href="#getting-the-apk" title="Direct link to heading">#</a></h2><p>You need an APK first in order to analyze it. You can get this directly from your phone or use a site such as <a href="https://www.apkmirror.com/" target="_blank" rel="noopener noreferrer">apkmirror</a>. The rest of this guide assumes that you have downloaded <code>example.apk</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="decompile-the-apk"></a>Decompile the APK<a class="hash-link" href="#decompile-the-apk" title="Direct link to heading">#</a></h2><p>While Mariana Trench does not require the source for the analysis, the results are hard to process without any source reference.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> jadx</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ jadx -e example.apk</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The latter will attempt to decompile the apk and store the results in a <code>example/</code> directory.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="run-mariana-trench"></a>Run Mariana Trench<a class="hash-link" href="#run-mariana-trench" title="Direct link to heading">#</a></h2><p>We are now ready to run the analysis:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ mariana-trench --apk-path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">example.apk --source-root-directory</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">example/src/main/java/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Once the analysis terminates we can do our usual post-processing and look at the results:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sapp --tool</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mariana-trench analyze </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sapp --database-name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">sapp.db server --source-directory</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">example/src/main/java/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The major limitation of this current approach is that the location information Mariana Trench uses is coming from bytecode instructions, not from the source that we decompiled. This means going through the traces is extra tedious. We welcome suggestions or pull-requests to improve this process.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://www.internalfb.com/intern/diffusion/FBS/browse/master/fbandroid/native/mariana-trench/documentation/website/documentation/running_on_3rd_party_apps.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/models"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Models</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/developers-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Developer&#x27;s Guide »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-the-apk" class="table-of-contents__link">Getting the APK</a></li><li><a href="#decompile-the-apk" class="table-of-contents__link">Decompile the APK</a></li><li><a href="#run-mariana-trench" class="table-of-contents__link">Run Mariana Trench</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/fbOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/mariana-trench" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div class="footer__copyright">Copyright © 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.032abe41.js"></script>
<script src="/runtime~main.4d463931.js"></script>
<script src="/main.5b59f7f6.js"></script>
<script src="/common.cb11aae3.js"></script>
<script src="/2.b3ce0de2.js"></script>
<script src="/1be78505.33ff38f6.js"></script>
<script src="/25.b8db153a.js"></script>
<script src="/935f2afb.4c698189.js"></script>
<script src="/17896441.f69af79b.js"></script>
<script src="/6bf0c53e.4997e5fe.js"></script>
</body>
</html>