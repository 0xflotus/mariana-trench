(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return s}));var a=n(3),r=n(7),l=(n(0),n(105)),i={id:"developers-guide",title:"Developer's Guide",sidebar_label:"Developer's Guide"},c={unversionedId:"developers-guide",id:"developers-guide",isDocsHomePage:!1,title:"Developer's Guide",description:"This documentation aims to help you become an active contributor to Mariana Trench.",source:"@site/documentation/developers_guide.md",slug:"/developers-guide",permalink:"/docs/developers-guide",version:"current",sidebar_label:"Developer's Guide",sidebar:"someSidebar",previous:{title:"Running on 3rd-Party Apps",permalink:"/docs/running-on-3rd-party-apps"}},o=[{value:"Building From Source",id:"building-from-source",children:[{value:"Dependencies",id:"dependencies",children:[]},{value:"Building Mariana Trench",id:"building-mariana-trench",children:[]}]},{value:"Development",id:"development",children:[]},{value:"Run the tests",id:"run-the-tests",children:[]}],b={toc:o};function s(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"This documentation aims to help you become an active contributor to Mariana Trench."),Object(l.b)("h2",{id:"building-from-source"},"Building From Source"),Object(l.b)("h3",{id:"dependencies"},"Dependencies"),Object(l.b)("p",null,"Below is a list of the required dependencies. Most of them can be installed with a package manager."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"A C++ compiler that supports C++17 (GCC >= 7 or Clang >= 5)"),Object(l.b)("li",{parentName:"ul"},"Python >= 3.6"),Object(l.b)("li",{parentName:"ul"},"CMake >= 3.19.3"),Object(l.b)("li",{parentName:"ul"},"zlib"),Object(l.b)("li",{parentName:"ul"},"Boost >= 1.75.0"),Object(l.b)("li",{parentName:"ul"},"GoogleTest >= 1.10.0"),Object(l.b)("li",{parentName:"ul"},"JsonCpp >= 1.9.4"),Object(l.b)("li",{parentName:"ul"},"fmt >= 7.1.2"),Object(l.b)("li",{parentName:"ul"},"RE2"),Object(l.b)("li",{parentName:"ul"},"Java (Optional)"),Object(l.b)("li",{parentName:"ul"},"Android SDK (Optional)"),Object(l.b)("li",{parentName:"ul"},"Redex (master)")),Object(l.b)("h4",{id:"macos"},"MacOS"),Object(l.b)("p",null,"Here are the steps to install Mariana Trench on ",Object(l.b)("strong",{parentName:"p"},"macOS")," using ",Object(l.b)("strong",{parentName:"p"},Object(l.b)("a",Object(a.a)({parentName:"strong"},{href:"https://brew.sh/"}),"Homebrew")),"."),Object(l.b)("p",null,"First, you will need to choose a temporary directory to store the C++ binaries and libraries. You can safely remove these after installation if you do not intend to update the C++ code. We will refer to this temporary directory as ",Object(l.b)("inlineCode",{parentName:"p"},"<temporary-directory>")," in the following instructions."),Object(l.b)("p",null,"You will need Xcode with command line tools installed. To get the command line tools, use:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"$ xcode-select --install\n")),Object(l.b)("p",null,"Then, install all the required dependencies with ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://brew.sh/"}),"Homebrew"),":"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"$ brew upgrade\n$ brew install python3 cmake zlib boost googletest jsoncpp fmt re2\n")),Object(l.b)("h4",{id:"redex"},"Redex"),Object(l.b)("p",null,"Now, let's build ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://fbredex.com/"}),"Redex")," from source:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'$ brew install git\n$ git clone https://github.com/facebook/redex.git\n$ cd redex\n$ mkdir build\n$ cd build\n$ cmake -DCMAKE_INSTALL_PREFIX="<temporary-directory>" ..\n$ make -j4\n$ make install\n')),Object(l.b)("h3",{id:"building-mariana-trench"},"Building Mariana Trench"),Object(l.b)("p",null,"Now that we have our dependencies ready, let's build the Mariana Trench binary:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'$ cd ../..  # Go back to the root directory\n$ mkdir build\n$ cd build\n$ cmake -DREDEX_ROOT="<temporary-directory>" -DCMAKE_INSTALL_PREFIX="<temporary-directory>" ..\n$ make -j4\n$ make install\n')),Object(l.b)("p",null,"Finally, let's install Mariana Trench as a Python package.\nWe recommend to run this step inside a ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://packaging.python.org/tutorials/installing-packages/#creating-virtual-environments"}),"virtual environment"),"."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'$ cd .. # Go back to the root directory\n$ python scripts/setup.py \\\n  --binary "<temporary-directory>/bin/mariana-trench-binary" \\\n  --pyredex "<temporary-directory>/bin/pyredex" \\\n  install\n')),Object(l.b)("h2",{id:"development"},"Development"),Object(l.b)("p",null,"If you are making changes to Mariana Trench, you can use the ",Object(l.b)("inlineCode",{parentName:"p"},"mariana-trench")," wrapper inside the build directory:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"$ cd build\n$ ./mariana-trench --help\n")),Object(l.b)("p",null,"This way, you don't have to use ",Object(l.b)("inlineCode",{parentName:"p"},"scripts/setup.py")," between every changes.\nPython changes will be automatically picked up.\nC++ changes will be picked up after running ",Object(l.b)("inlineCode",{parentName:"p"},"make"),"."),Object(l.b)("p",null,"Note that you will need to install all python dependencies:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"$ pip install pyre_extensions fb-sapp\n")),Object(l.b)("h2",{id:"run-the-tests"},"Run the tests"),Object(l.b)("p",null,"To run the tests after building Mariana Trench, use:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"$ cd build\n$ make check\n")))}s.isMDXComponent=!0}}]);